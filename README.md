# Loop-
 Global $GsDesiredCapabilities Global $GsSession $_WD_DEBUG = $_WD_DEBUG_Error SetUpFireFox() _WD_Startup()  $GsSession = _WD_CreateSession($GsDesiredCapabilities) _WD_Navigate($GsSession, "https://www.washingtonpost.com") _WD_LoadWait($GsSession, 1000, 2000)  Global $nytHandle = _WD_NewTab($GsSession, True, Default, "https://www.nytimes.com") _WD_LoadWait($GsSession, 1000, 2000)  $nytHandle = _WD_NewTab($GsSession, True, Default, "https://www.nytimes.com") _WD_LoadWait($GsSession, 1000, 2000)  ;~ AdlibRegister("checkNYT", 1000)  ;~ $Handle = _WD_Window($GsSession, 'new', '{"type":"window"}') $Handle = _WD_NewTab($GsSession, Default, Default, Default, "toolbar=yes, width=1000, height=1500") Sleep(2000) _WD_Window($GsSession, 'Switch', '{"handle":"' &amp; $Handle &amp; '"}') _WD_Navigate($GsSession, 'https://www.macrumors.com') ;~ WinSetState("MacRumors: ", '',  @SW_MINIMIZE)  Sleep(2000)  _WD_DeleteSession($GsSession) _WD_Shutdown()  ; The "asynchronous" execution of this causes the issue with _WD_Window() Func checkNYT()     Local $url = _WD_Action($GsSession, 'URL')     If StringInStr($url, 'nytimes') > 0 Then         ConsoleWrite("Reading New York Times" &amp; @CR)     Else         ; This should attach to the most "recent" NYT page.         ;~ _WD_Attach($GsSession, $nytHandle)         ConsoleWrite("Switching to New York Times" &amp; @CR)          _WD_Window($GsSession, 'Switch', '{"handle":"' &amp; $nytHandle &amp; '"}')      EndIf EndFunc  Func SetupFireFox()     _WD_Option('Driver', 'geckodriver.exe')     _WD_Option('DriverParams', '--marionette-port 2828')     _WD_Option('Port', 4444)      $GsDesiredCapabilities = '{"capabilities": {"alwaysMatch": {"moz:firefoxOptions": {"args": ["-profile", "' &amp; getDefaultFFProfile() &amp; '"]}}}}' EndFunc   ;==>SetupFireFox  Func getDefaultFFProfile()     Local $sDefault, $sProfilePath = ''      Local $sProfilesPath = StringReplace(@AppDataDir, '\', '/') &amp; "/Mozilla/Firefox/"     Local $sFilename = $sProfilesPath &amp; "profiles.ini"     Local $aSections = IniReadSectionNames($sFilename)      If Not @error Then         For $i = 1 To $aSections[0]             $sDefault = IniRead($sFilename, $aSections[$i], 'Default', '0')              If $sDefault = '1' Then                 $sProfilePath = $sProfilesPath &amp; IniRead($sFilename, $aSections[$i], "Path", "")                 ExitLoop             EndIf         Next     EndIf     Return $sProfilePath EndFunc   ;==>getDefaultFFProfile
